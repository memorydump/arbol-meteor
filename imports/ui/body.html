

<body>
  <div class="container">
    <header>
      <img src="/images/green_circle_line1.png" alt="Arbol">
      <h1>A R B O L</h1>
    </header>
  </div>
  <div id="user">{{> user}}</div>
  <div id="web3-waiting">
    <h3>Waiting for Web3 to load.</h3>
  </div>
  <div id="no-web3" style="display:none" class="container">
    <h3>No Web3, consider using MetaMask: </h3>
    <a href="https://metamask.io/">
      <img src="/images/metamask-link.png" alt="Download MetaMask" height="120">
    </a>
  </div>
  <div id="web3-onload" class="disabled-div" style="display:none">
    {{> navigation}}
  </div>
</body>

<template name="user">
  <h3>
    {{#each activeUser}}
      {{name}}
    {{/each}}
  </h3>
</template>

<template name="navigation">
  <!-- Use `name` to add a custom class to the outer container -->
  {{#basicTabs name="newTabs" tabs=tabs}}
    <!--
      There are two ways to define content for your tabs:

      1. Wrap each tabbed section in a blank `<div></div>`.
         Sections must correspond with the order of the tabs you specified.

      2. Wrap each tabbed section in the provided block helper (RECOMMENDED!).
         `{{#tabContent slug="nameOfSlug"}} ... {{/tabContent}}`
         These can be defined in any order you like.
    -->

    <!-- "OPEN PROTECTIONS" TAB -->
    {{#tabContent slug="open"}}
      <table style="display:none">
        <tr>
          <td>Filter:</td>
          <td>Loaded Tokens:</td>
        </tr>
        <tr>
          <td>{{> filter}}</td>
          <td>{{> tokens}}</td>
        </tr>
      </table>
      All open protections (sort ascending/descending will only affect loaded data):
      {{> openProtectionsTable}}
    {{/tabContent}}

    <!-- "CREATE A PROTECTION" TAB -->
    {{#tabContent slug="create"}}
      Select the options for the protection you want to create. Make sure you have enough Eth in your wallet, and if you are selling a protection, make sure you have enough ARBOL in your wallet as well.
      {{> formNewProtection}}
    {{/tabContent}}

    <!-- "MY PROTECTIONS" TAB -->
    {{#tabContent slug="mine"}}
      All of your protections:
      {{> myProtectionsTable}}
    {{/tabContent}}
  {{/basicTabs}}
</template>

<!-- TEMPLATES FOR SORTABLE TABLE -->

<template name="headerRow">
  <tr>
    {{#each column}}
      <th> {{name}} </th>
    {{/each}}
  </tr>
</template>

<template name="sortableRows">
  <tr>
    {{#if isEqual type "headerRow"}}
      {{#each column}}
        <th> {{name}} </th>
      {{/each}}
    {{else if isEqual type "bodyRow"}}
      {{#each column}}
        <td>
          {{#if isEqual type "text"}}
            {{{name}}}
          {{else if isEqual type "num"}}
            {{name}}
          {{else if isEqual type "button"}}
            {{{button}}}
          {{/if}}
        </td>
      {{/each}}
    {{/if}}
  </tr>
</template>

<!-- TEMPLATES FOR "OPEN PROTECTIONS" -->

<template name="filter">
  <table>
    {{#each filterInput}}
      {{> elFilter}}
    {{/each}}
  </table>
</template>

<template name="elFilter">
  <tr>
    <td>
      <div class="tooltip">
        {{title}}
        <span class="tooltiptext">{{tooltiptext}}</span>
      </div>
    </td>
    <td>
      {{#if isEqual type "number"}}
        <input type="{{type}}" id={{id}} name={{name}} class="filter" step="1" value="0" min="0">
      {{/if}}
    </td>
  </tr>
</template>

<template name="tokens">
  <table>
    {{#each tokensInput}}
      {{> elTokens}}
    {{/each}}
  </table>
</template>

<template name="elTokens">
  <tr>
    <td>
      <div class="tooltip">
        {{title}}
        <span class="tooltiptext">{{tooltiptext}}</span>
      </div>
    </td>
    <td>
      {{#if isEqual type "number"}}
        <input type="{{type}}" id={{id}} name={{name}} class="tokens fresh" step="1" value="0" min="1" disabled>
      {{/if}}
    </td>
  </tr>
</template>

<template name="openProtectionsTable">
  <div class="wrapper loading">
    <table id="openProtections" class="table-sorter">
      <thead>
        {{#each headerData}}
          {{> headerRow}}
        {{/each}}
      </thead>
      <tbody>
        {{#each bodyData}}
          {{> sortableRows}}
        {{/each}}
      </tbody>
    </table>
    <div class="loader"></div>
  </div>
  <div id="open-pager-btns" class="pager-btns" style="display:none"> {{> openPagination}}</div>
</template>

<template name="openPagination">
    <input type="button" id="open-back" value="Back">
    <input type="button" id="open-forward" value="Forward">
</template>

<!-- TEMPLATES FOR "CREATE A PROTECTION FORM" -->

<template name="formNewProtection">
  <form class="new-protection">
    <input type="submit" id="create-request" value="Create Request">
    <input type="button" id="createRandom" value="Fill Form Randomly">
    <table>
      <tr>
        <td>
          <table>
            {{#each formNewProtection}}
              {{> elNewProtection}}
            {{/each}}
          </table>
        </td>
        <td>
          <div class="tooltip"> Location: <span class="tooltiptext">"Select the geographic area covered by the contract."</span></div>
          <span id="selected-region"> </span><br>
          <select id="location" name="location" hidden>
            <option value="us-corn-belt" selected>"US Corn Belt"</option>
            <option value="us-soy-belt" selected>"US Soy Belt"</option>
          </select>
          <svg id="map" width="500" height="300">
            <g id="outline"></g>
            <g id="areas">
              <path id="cornbelt" name="US Corn Belt" value="0" class="ag-areas" d="M200,175L300,175L300,100L200,100" stroke="blue" stroke-width="4" fill="blue"></path>
              <path id="soybelt" name="US Soy Belt" value="1" class="ag-areas" d="M0,175L100,175L100,100L0,100" stroke="red" stroke-width="4" fill="red"></path>
            </g>
          </svg>
        </td>
        <td>
          <table>
            <tr>
              <td>
                <div class="tooltip"> From: <span class="tooltiptext">"The starting month of the contract."</span></div>
              </td>
              <td>
                <input type="month" id="start-date" name="start-date" class="date-picker">
              </td>
            </tr>
            <tr>
              <td>
                <div class="tooltip"> To: <span class="tooltiptext">"The ending month of the contract."</span></div>
              </td>
              <td>
                <input type="month" id="end-date" name="end-date" class="date-picker">
              </td>
            </tr>
          </table>
          <svg id="chart" width="400" height="300"></svg>
        </td>
      </tr>
    </table>
  </form>
</template>

<template name="elNewProtection">
  <tr>
    <td>
      <div class="tooltip">
        {{title}}
        <span class="tooltiptext">{{tooltiptext}}</span>
      </div>
    </td>
    <td>
      {{#if isEqual type "number"}}
        <input type="{{type}}" id={{id}} name={{name}} class="contribution" step="1" value="0" min="0" style="width:80px">
      {{else if isEqual type "payout"}}
        <div><strong id={{id}}>0</strong></div>
      {{else if isEqual type "toggle"}}
        <label class="buy-sell"><input type="checkbox" id={{id}}><div class="slider round"><span class="buy">BUY</span><span class="sell">SELL</span></div></label>
      {{/if}}
    </td>
  </tr>
</template>

<!-- TEMPLATES FOR "MY PROTECTIONS" -->

<template name="myProtectionsTable">
  <div class="wrapper loading">
    <table id="myProtections" class="table-sorter">
      <thead>
        {{#each headerData}}
          {{> headerRow}}
        {{/each}}
      </thead>
      <tbody>
        {{#each bodyData}}
          {{> sortableRows}}
        {{/each}}
      </tbody>
    </table>
    <div class="loader"></div>
  </div>
  <div id="my-pager-btns" class="pager-btns" style="display:none"> {{> myPagination}}</div>
</template>

<template name="myPagination">
    <input type="button" id="my-back" value="Back">
    <input type="button" id="my-forward" value="Forward">
</template>
