

<body>
  <div class="container">
    <header>
      <img src="/images/green_circle_line1.png" alt="Arbol">
      <h1>A R B O L</h1>
    </header>
  </div>
  <div id="user">{{> user}}</div>
  <div id="web3-waiting">
    <h3>Waiting for Web3 to load.</h3>
  </div>
  <div id="no-web3" style="display:none" class="container">
    <h3>No Web3, consider using MetaMask: </h3>
    <a href="https://metamask.io/">
      <img src="/images/metamask-link.png" alt="Download MetaMask" height="120">
    </a>
  </div>
  <div id="web3-onload" style="display:none">
    {{> navigation}}
  </div>
</body>

<template name="user">
  <h3>
    {{#each activeUser}}
      {{name}}
    {{/each}}
  </h3>
</template>

<template name="navigation">
  <!-- Use `name` to add a custom class to the outer container -->
  {{#basicTabs name="newTabs" tabs=tabs}}
    <!--
      There are two ways to define content for your tabs:

      1. Wrap each tabbed section in a blank `<div></div>`.
         Sections must correspond with the order of the tabs you specified.

      2. Wrap each tabbed section in the provided block helper (RECOMMENDED!).
         `{{#tabContent slug="nameOfSlug"}} ... {{/tabContent}}`
         These can be defined in any order you like.
    -->

    <!-- "OPEN PROTECTIONS" TAB -->
    {{#tabContent slug="open"}}
      <table>
        <tr>
          <td>Filter:</td>
          <td>Loaded Tokens:</td>
        </tr>
        <tr>
          <td>{{> filter}}</td>
          <td>{{> tokens}}</td>
        </tr>
      </table>
      All open protections (sort ascending/descending will only affect loaded data):
      {{> openProtectionsTable}}
    {{/tabContent}}

    <!-- "CREATE A PROTECTION" TAB -->
    {{#tabContent slug="create"}}
      Select the options for the protection you want to create. Make sure you have enough Wei in your wallet, and if you are selling a protection, make sure you have enough ARBOL in your wallet as well.
      {{> formNewProtection}}
    {{/tabContent}}

    <!-- "MY PROTECTIONS" TAB -->
    {{#tabContent slug="mine"}}
      All of your protections:
      {{> myProtectionsTable}}
    {{/tabContent}}
  {{/basicTabs}}
</template>

<!-- TEMPLATES FOR SORTABLE TABLE -->
<template name="filterRow">
</template>

<template name="headerRow">
  <tr>
    {{#each column}}
      <th> {{name}} </th>
    {{/each}}
  </tr>
</template>

<template name="sortableRows">
  <tr>
    {{#if isEqual type "headerRow"}}
      {{#each column}}
        <th> {{name}} </th>
      {{/each}}
    {{else if isEqual type "bodyRow"}}
      {{#each column}}
        <td>
          {{#if isEqual type "text"}}
            {{{name}}}
          {{else if isEqual type "num"}}
            {{name}}
          {{else if isEqual type "button"}}
            {{{button}}}
          {{/if}}
        </td>
      {{/each}}
    {{/if}}
  </tr>
</template>

<!-- TEMPLATES FOR "OPEN PROTECTIONS" -->

<template name="filter">
  <table>
    {{#each filterInput}}
      {{> elFilter}}
    {{/each}}
  </table>
</template>

<template name="elFilter">
  <tr>
    <td>
      <div class="tooltip">
        {{title}}
        <span class="tooltiptext">{{tooltiptext}}</span>
      </div>
    </td>
    <td>
      {{#if isEqual type "number"}}
        <input type="{{type}}" id={{id}} name={{name}} class="filter" step="100" value="0" min="0">
      {{/if}}
    </td>
  </tr>
</template>

<template name="tokens">
  <table>
    {{#each tokensInput}}
      {{> elTokens}}
    {{/each}}
  </table>
</template>

<template name="elTokens">
  <tr>
    <td>
      <div class="tooltip">
        {{title}}
        <span class="tooltiptext">{{tooltiptext}}</span>
      </div>
    </td>
    <td>
      {{#if isEqual type "number"}}
        <input type="{{type}}" id={{id}} name={{name}} class="tokens fresh" step="1" value="0" min="1" disabled>
      {{/if}}
    </td>
  </tr>
</template>

<template name="openProtectionsTable">
  <div class="wrapper loading">
    <table id="openProtections" class="tablesorter">
      <thead>
        {{#each headerData}}
          {{> headerRow}}
        {{/each}}
      </thead>
      <tbody>
        {{#each bodyData}}
          {{> sortableRows}}
        {{/each}}
      </tbody>
    </table>
    {{> pagination}}
    <div class="loader"></div>
  </div>
</template>

<template name="pagination">
  <div id="pagination-buttons">
    <input type="button" id="back" value="Back">
    <input type="button" id="forward" value="Forward">
  </div>
</template>

<!-- TEMPLATES FOR "CREATE A PROTECTION FORM" -->

<template name="formNewProtection">
  <form class="new-protection">
    <input type="button" id="createRandom" value="Fill Form Randomly">
    <table>
      {{#each formNewProtection}}
        {{> elNewProtection}}
      {{/each}}
    </table>
    <div class="buttonHolder">
      <input type="submit" id="create-request" value="Create Request">
    </div>
  </form>
</template>

<template name="elNewProtection">
  <tr>
    <td>
      <div class="tooltip">
        {{title}}
        <span class="tooltiptext">{{tooltiptext}}</span>
      </div>
    </td>
    <td>
      {{#if isEqual type "date"}}
        <input type="{{type}}" id={{id}} name={{name}} class="date-picker" min={{minDate}}>
      {{else if isEqual type "number"}}
        <input type="{{type}}" id={{id}} name={{name}} class="contribution" step="100" value="0" min="0">
      {{else if isEqual type "payout"}}
        <div><strong id={{id}}>0</strong></div>
      {{else if isEqual type "select"}}
        <select id={{id}} name={{name}}>
          <option value="" selected disabled hidden>Select {{article}} {{name}}</option>
          {{#each elOptions}}
            <option value={{value}}>{{text}}</option>
          {{/each}}
        </select>
      {{else if isEqual type "toggle"}}
        <label class="buy-sell"><input type="checkbox" id={{id}}><div class="slider round"><span class="buy">BUY</span><span class="sell">SELL</span></div></label>
      {{/if}}
    </td>
  </tr>
</template>

<!-- TEMPLATES FOR "MY PROTECTIONS" -->

<template name="myProtectionsTable">
  <table id="myProtections" class="tablesorter">
    <thead>
      {{#each headerData}}
        {{> headerRow}}
      {{/each}}
    </thead>
    <tbody>
      {{#each bodyData}}
        {{> sortableRows}}
      {{/each}}
    </tbody>
  </table>
</template>
